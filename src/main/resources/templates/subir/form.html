<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/layout :: head('Subir Preguntas')"></head>

<body class="bg-sky-50">
    <header th:replace="fragments/layout :: header"></header>

    <main class="container mx-auto p-6 max-w-4xl">
        <div class="mb-6">
            <h1 class="text-2xl font-bold text-gray-800">Subir Preguntas desde Archivo</h1>
            <p class="text-gray-600 mt-1">Importa preguntas masivamente desde un archivo JSON o CSV</p>
        </div>

        <!-- Mensajes de 茅xito/error -->
        <div th:if="${success}" class="mb-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded">
            <span th:text="${success}"></span>
        </div>
        <div th:if="${warning}" class="mb-4 bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded">
            <span th:text="${warning}"></span>
        </div>
        <div th:if="${error}" class="mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
            <span th:text="${error}"></span>
        </div>

        <!-- Errores detallados -->
        <div th:if="${errors != null and !errors.isEmpty()}" class="mb-4 bg-red-50 border border-red-200 rounded p-4">
            <h3 class="font-semibold text-red-800 mb-2">Errores encontrados:</h3>
            <ul class="list-disc list-inside text-sm text-red-700">
                <li th:each="err : ${errors}" th:text="${err}"></li>
            </ul>
        </div>

        <!-- Formulario de subida -->
        <div class="bg-orange-100 rounded-lg shadow-sm p-6 border border-orange-200 mb-6">
            <form th:action="@{/upload}" method="post" enctype="multipart/form-data" class="space-y-4">
                <div th:replace="fragments/forms :: csrf"></div>

                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        Selecciona un archivo (JSON o CSV)
                    </label>
                    <input type="file" name="file" accept=".json,.csv"
                        class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-500"
                        required />
                    <p class="mt-2 text-sm text-gray-600">
                        Formatos soportados: JSON (.json) o CSV (.csv)
                    </p>
                </div>

                <div class="flex gap-3 pt-4">
                    <button type="submit" class="bg-orange-600 text-white px-6 py-2 rounded hover:bg-orange-700">
                        Subir Archivo
                    </button>
                    <a href="/" class="bg-gray-300 text-gray-700 px-6 py-2 rounded hover:bg-gray-400">
                        Volver al inicio
                    </a>
                </div>
            </form>
        </div>

        <!-- Instrucciones -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Formato JSON -->
            <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                <h2 class="text-xl font-bold text-gray-800 mb-4"> Formato JSON</h2>
                <p class="text-sm text-gray-600 mb-3">Ejemplo de estructura:</p>
                <pre class="bg-gray-100 p-3 rounded text-xs overflow-x-auto"><code>{
  "trueFalse": [
    {
      "statement": "La Tierra es plana",
      "correctAnswer": false,
      "explanation": "La Tierra es un geoide"
    }
  ],
  "singleChoice": [
    {
      "statement": "驴Capital de Espa帽a?",
      "options": ["Madrid", "Barcelona", "Sevilla"],
      "correctIndex": 0,
      "explanation": "Madrid es la capital"
    }
  ],
  "multipleChoice": [
    {
      "statement": "Lenguajes de programaci贸n",
      "options": ["Java", "Python", "HTML", "CSS"],
      "correctIndexes": [0, 1],
      "explanation": "HTML y CSS son lenguajes de marcado"
    }
  ]
}</code></pre>
            </div>

            <!-- Formato CSV -->
            <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                <h2 class="text-xl font-bold text-gray-800 mb-4"> Formato CSV</h2>
                <p class="text-sm text-gray-600 mb-3">Estructura del CSV:</p>
                <pre class="bg-gray-100 p-3 rounded text-xs overflow-x-auto"><code>tipo,enunciado,datos,respuesta,explicacion
VF,La Tierra es plana,false,,La Tierra es un geoide
SC,Capital de Espa帽a,Madrid;Barcelona;Sevilla,0,Madrid es la capital
MC,Lenguajes,Java;Python;HTML;CSS,0;1,HTML y CSS son marcado</code></pre>
                <div class="mt-4 text-sm text-gray-700">
                    <p class="font-semibold mb-2">Tipos:</p>
                    <ul class="list-disc list-inside space-y-1 text-xs">
                        <li><strong>VF</strong>: Verdadero/Falso</li>
                        <li><strong>SC</strong>: Selecci贸n nica</li>
                        <li><strong>MC</strong>: Selecci贸n M煤ltiple</li>
                    </ul>
                    <p class="mt-3 text-xs text-gray-600">
                        <strong>Nota:</strong> Las opciones y respuestas m煤ltiples se separan con punto y coma (;)
                    </p>
                </div>
            </div>
        </div>

        <!-- Bot贸n de descarga de ejemplo -->
        <div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
            <h3 class="font-semibold text-blue-800 mb-2"> Archivos de ejemplo</h3>
            <p class="text-sm text-blue-700 mb-3">
                Descarga archivos de ejemplo para ver el formato correcto (puedes utilizarlo como plantilla):
            </p>
            <div class="flex gap-3">
                <a href="/examples/preguntas-example.json" download
                    class="text-sm bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                    Descargar ejemplo JSON
                </a>
                <a href="/examples/preguntas-example.csv" download
                    class="text-sm bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                    Descargar ejemplo CSV
                </a>
            </div>
        </div>
    </main>

    <footer th:replace="fragments/layout :: footer"></footer>
</body>

</html>
